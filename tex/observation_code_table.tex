\pgfplotstabletypeset[
    empty header,
    begin table=\begin{longtable},
    every head row/.style={output empty row},
    every nth row={1}{before row=\hline},
    every first row/.append style={
        before row={%
            % Initial caption
            \caption{Observation code table}
            \label{tab:DataTable}\\
            % Initial column headers
            \hline\hline \multicolumn{1} { > {\centering}V{2 in}} { \textbf{Value}} &\multicolumn{1} { > {\centering}V{2 in}} { \textbf{code _table _scheme}} &\multicolumn{1} { > {\centering}V{2 in}} { \textbf{code _table _id}} & \multicolumn{1} { > {\centering} V{4 in} } {\textbf{Code Table Name}} \\ \hline\hline \endfirsthead
            \multicolumn{4}{c}{Table \thetable\ Observation code table (cont.)} \\
            % column headers on additional pages
            \hline\hline \multicolumn{1} { > {\centering}V{2 in} } { \textbf{Value}} &\multicolumn{1} { > {\centering}V{2 in} } { \textbf{code _table _scheme}} &\multicolumn{1} { > {\centering}V{2 in} } { \textbf{code _table _id}} & \multicolumn{1} { > {\centering} V{4 in} } {\textbf{Code Table Name}} \\ \hline\hline \endhead
            % Footer on 1st to penultimate pages
            \multicolumn{4}{r}{{Continued on next page}} \\
            \endfoot
            % Footer on last page of table
            \hline
            \multicolumn{4}{r}{{End of table}} \\ 
            \endlastfoot
        }
    },
    %
    end table=\end{longtable},
    col sep=tab,
    string type,
    columns/Value/.style={
            string type, 
            column type= V{2 in}, 
            string replace*={_}{}
        },
    columns/code _table _scheme/.style={
            string type, 
            column type= V{2 in}, 
            string replace*={_}{}
        },
    columns/code _table _id/.style={
            string type, 
            column type= V{2 in}, 
            string replace*={_}{}
        },
    columns/Code Table Name/.style={
            string type, 
            string replace*={_}{},
            column type = V{4 in}
        }
    ]{/Users/dyb/GitHub/C3S_311a_CDM/tables/observation_code_table.csv}
